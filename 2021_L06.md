# MIS132 ç¨‹å¼è¨­è¨ˆå¯¦ç¿’ - Lecture06

## Outline this week

- Module
  - ä»‹ç´¹
  - åŸºæœ¬ä½¿ç”¨
- Built-in Module
- Third-Party Module
- Lab ç·´ç¿’

## ä»‹ç´¹
### What is module?

Function ç”±å¾ˆå¤šè¡Œ code çµ„æˆ

Module å‰‡å¯ä»¥è¢«ç†è§£æˆå¾ˆå¤š Function, Variable, class ......ç­‰çš„é›†åˆé«”

åˆ°ç›®å‰ç‚ºæ­¢ï¼Œæˆ‘å€‘å¯«çš„æ¯å€‹æª”æ¡ˆå…¶å¯¦ä¹Ÿéƒ½ç®—æ˜¯ä¸€å€‹ Module

Module å¯ä»¥è‡ªå·±å»ºç«‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Python å…§å»ºçš„ï¼Œæˆ–ä¸‹è¼‰åˆ¥äººå»ºç«‹å¥½çš„ã€‚

### Why module?

æœ‰äº›ç¨‹å¼ç¢¼æ“æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š**è¤‡é›œã€å¾ˆå¸¸ä½¿ç”¨ã€å¾ˆå†—é•·** => æˆ‘å€‘å¯ä»¥å¯«ä¸€å€‹ function å»åŒ…è£ç¨‹å¼å…§å®¹

ç•¶é€™å€‹å¾ˆè¤‡é›œçš„ç¨‹å¼ç¢¼ï¼Œåœ¨ A.py, B.py, C.pyä¸­éƒ½æœƒç”¨åˆ° => æŠŠé€™å€‹functionè¤‡è£½åˆ°æ¯å€‹æª”æ¡ˆä¸­å—ï¼Ÿ

**NO**ï¼Œæˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€å€‹ .py çš„ Moduleï¼ŒæŠŠ Function æ”¾åœ¨è£¡é¢ï¼Œæ¯å€‹è¦ä½¿ç”¨è©² Function çš„æª”æ¡ˆå» import é€™å€‹å…±ç”¨çš„ Module => é€™å°±æ˜¯ Module

---
ç”¨ Module æ€è€ƒã€æŠŠæª”æ¡ˆåˆ‡é–‹ä¾†æœ‰ä»€éº¼å¥½è™•ï¼Ÿ

1. Simplicity ç°¡å–®
    - å¦‚æœä½¿ç”¨ Module åœ¨æ€è€ƒï¼Œä½ å¯ä»¥æŠŠæ•´å€‹å¤§å•é¡Œåˆ‡å‰²æˆå¾ˆå¤šå°éƒ¨åˆ†ï¼Œæ¯æ¬¡å°ˆæ³¨æ–¼è§£æ±ºä¸€å€‹å°å•é¡Œï¼Œé€™æ¨£å¯«èµ·ä¾†æœƒæ¯”è¼ƒç°¡å–®
    - Function æˆ– Module å¦‚æœä¸æ˜¯é€™å€‹æª”æ¡ˆçš„é‡é»ï¼Œæˆ‘å€‘å¯ä»¥è®“ç¾åœ¨çš„ Python Code è®Šçš„ä¹¾æ·¨ã€å¥½é–±è®€
2. Maintainability æ˜“æ–¼ç¶­è­·
    å¦‚æœ Function çš„å…§å®¹è¦ä¿®æ”¹ï¼Œæˆ‘å€‘ä¸ç”¨å»æ¯å€‹æª”æ¡ˆé€²è¡Œä¿®æ”¹ï¼Œåªéœ€è¦ä¿®æ”¹ Moduleï¼Œå…¨éƒ¨æª”æ¡ˆéƒ½æœƒè¢«æ”¹è®Š
3. Reusability å¯é‡è¤‡ä½¿ç”¨
    å› ç‚ºæˆ‘å€‘å°ˆæ³¨æ–¼å–®ä¸€å•é¡Œï¼Œæ‰€ä»¥ä¸‹æ¬¡é‡åˆ°é€™å€‹å•é¡Œæ™‚ï¼Œå°±å¯ä»¥æŠŠä¸Šæ¬¡å¯«çš„ Module æ‹¿å‡ºä¾†ç”¨ï¼Œæˆ–æ˜¯ä¹Ÿå¯ä»¥ä¸Šç¶²å»æ‰¾åˆ¥äººå¯«å¥½çš„ Moduleï¼Œä¹Ÿèƒ½è§£æ±ºå•é¡Œ
4. Namespace å‘½åç©ºé–“
    æ¯å€‹ Module éƒ½æœ‰ç¨ç«‹çš„ namespaceï¼Œå¯ä»¥ç¢ºä¿ main script çš„ namespace å¤ ç”¨ã€ä¸æœƒè¢«æ±¡æŸ“

#### Example

é‚„è¨˜å¾—ä¹‹å‰æ•™ function çš„æ™‚å€™ï¼Œç†ç§‘å¤ªå¤ªçš„ç¯„ä¾‹å—ï¼Ÿ
```python
def opening(topic):
    print('å—¨ï¼å¤§å®¶ä»Šå¤©éå¾—å¥½å—ï¼Ÿ') # function è£¡è¨˜å¾—ç¸®æ’å¾Œè¼¸å…¥ä½ è¦æ”¾å…¥çš„å…§å®¹ã€‚
    print('æ­¡è¿å›åˆ°ï¼¸ï¼¸å¤ªå¤ª')
    print('ä»Šå¤©æˆ‘å€‘è¦è¬›æ˜¯ ' + topic)
    print('-' * 20)
```
å‡è¨­ç†ç§‘å¤ªå¤ªçš„æ¯éƒ¨å½±ç‰‡å­—å¹•æª”éƒ½æ˜¯ä¸€å€‹æª”æ¡ˆ(.py)ï¼Œç„¶è€Œä»–çš„é–‹é ­æ¯æ¬¡éƒ½ä¸€æ¨£ï¼Œé€™æ™‚å€™æˆ‘å€‘å¯ä»¥é€éimportå»ºç«‹å¥½çš„ Moduleï¼Œä¾†ç¯€çœæˆ‘å€‘å¯« code çš„æ™‚é–“ã€‚


```python
import L06_module

# day 1
L06_module.opening('day1 - Youtube')
print('å…§å®¹ of day1')
```

    å—¨ï¼å¤§å®¶ä»Šå¤©éå¾—å¥½å—ï¼Ÿ
    æ­¡è¿å›åˆ°ï¼¸ï¼¸å¤ªå¤ª
    ä»Šå¤©æˆ‘å€‘è¦è¬›æ˜¯ day1 - Youtube
    --------------------
    å…§å®¹ of day1



```python
# day 2
L06_module.opening('day2 - Facebook')
print('å…§å®¹ of day2')
```

    å—¨ï¼å¤§å®¶ä»Šå¤©éå¾—å¥½å—ï¼Ÿ
    æ­¡è¿å›åˆ°ï¼¸ï¼¸å¤ªå¤ª
    ä»Šå¤©æˆ‘å€‘è¦è¬›æ˜¯ day2 - Facebook
    --------------------
    å…§å®¹ of day2


**æ³¨æ„ï¼šå¾ä¸Šé¢çš„ç¨‹å¼ç¢¼å¯ä»¥çœ‹åˆ°è¦å‘¼å«æŸå€‹ Module è£¡é ­çš„ functionï¼Œå¿…é ˆä½¿ç”¨ "MODULE.FUNC_NAME" çš„æ–¹å¼åŸ·è¡Œã€‚**

## Step by Step learning module
### Create a Module
è¦å»ºç«‹ä¸€å€‹ Moduleï¼Œå°±æŠŠä½ è¦ç”¨çš„ code å­˜æˆä¸€å€‹ .py çš„æª”æ¡ˆå³å¯:

```python
# Save this code in a file named my_module.py
PI = 3.14159265

def pi_area(radius):
    area = radius * radius * PI
    return area
```

### Use a Module

é€é `import MODULE_NAME` çš„æ–¹å¼ï¼Œè¼‰å…¥å‰›å‰›å»ºç«‹å¥½çš„moduleï¼š

æ¥è‘—å¯ä»¥ä½¿ç”¨ `MODULE_NAME.FUNC_NAME` æˆ– `MODULE_NAME.VARIABLE_NAME` ä½¿ç”¨ `.` å»å‘¼å« module åº•ä¸‹çš„æˆå“¡ï¼Œ**è®Šæ•¸å’Œå‡½å¼éƒ½å¯ä»¥**


```python
# Import the module named mymodule, and call the function:
import my_module

# å‘¼å«è®Šæ•¸
print(my_module.PI)

# å‘¼å« Function
print(my_module.circle_area(3))
```

    3.14159265
    28.27433385


### Variables in Module
- The module can contain functions, as already described, but also variables of all types (arrays, dictionaries, objects etc):
Module å¯ä»¥åŒ…å«ä»»ä½•è®Šæ•¸ï¼ˆarray, dict......ç­‰ï¼‰

> Save this code in the file mymodule.py

```python
p1 = {
  "name": "John",
  "age": 36,
  "country": "Norway"
}
people = [p1, 'annie', 'Jack']
```


```python
import my_module

print('age', my_module.p1['age'])
print('p1', my_module.p1)
print('people', my_module.people)
```

    age 36
    p1 {'name': 'John', 'age': 36, 'country': 'Norway'}
    people [{'name': 'John', 'age': 36, 'country': 'Norway'}, 'annie', 'Jack']


NOTE!! 
- ç•¶ä¸€å€‹ç¨‹å¼å·²ç¶“ import éï¼Œåšäº†æ›´æ”¹å† import ä¸€æ¬¡ï¼Œä¸¦ç„¡æ³•è¦†è“‹ä¸Šæ¬¡ import çš„çµæœã€‚**ï¼ˆåœ¨.ipynbæª”ä¸­å¿…é ˆ restart kernel æ‰èƒ½é‡æ–° import æ–°çš„ Module é€²ä¾†ã€‚ï¼‰**

### Re-naming a Module
- å¦‚æœmoduleåç¨±å¤ªé•·ï¼Œç¨‹å¼åˆå¾ˆå¸¸éœ€è¦ç”¨åˆ°moduleè£¡é¢çš„å…§å®¹ï¼Œé€™æ™‚å€™å°±å¯ä»¥åœ¨importçš„æ™‚å€™å¹«moduleçµ¦å€‹æ¯”è¼ƒçŸ­çš„åç¨±ï¼



```python
# Create an alias for mymodule called mx:
import my_module as mx

a = mx.p1['age']
print(a)
```

    36


## Built-in Modules

Python å…§å»ºæœ‰å¾ˆå¤š Moduleï¼Œä½ åªè¦åœ¨ä½ éœ€è¦çš„æ™‚å€™è¼‰é€²ä¾†å°±å¯ä»¥ä½¿ç”¨


```python
# Import and use the platform module:
import platform

x = platform.system()
print(x)
```

    Linux



```python
import json

string = json.dumps(my_module.p1, indent='  ')
print('json', string)
```

    json {
      "name": "John",
      "age": 36,
      "country": "Norway"
    }


### Using the dir() Function
ä¹‹å‰æˆ‘æœ‰ä½¿ç”¨éä¸€å€‹ built-in function `dir()`ï¼Œä»–å¯ä»¥æŠŠæŸå€‹ Module æˆ– Object åº•ä¸‹å¯ä»¥ä½¿ç”¨çš„ variables æˆ– functions å°å‡ºä¾†


```python
# List all the defined names belonging to the a module:
import threading, sys

print(dir(threading))
print(dir(json))
```

    ['Barrier', 'BoundedSemaphore', 'BrokenBarrierError', 'Condition', 'Event', 'Lock', 'RLock', 'Semaphore', 'TIMEOUT_MAX', 'Thread', 'ThreadError', 'Timer', 'WeakSet', '_CRLock', '_DummyThread', '_MainThread', '_PyRLock', '_RLock', '__all__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', '_active', '_active_limbo_lock', '_after_fork', '_allocate_lock', '_count', '_counter', '_dangling', '_deque', '_enumerate', '_format_exc', '_islice', '_limbo', '_main_thread', '_newname', '_pickSomeNonDaemonThread', '_profile_hook', '_set_sentinel', '_shutdown', '_start_new_thread', '_sys', '_time', '_trace_hook', 'activeCount', 'active_count', 'currentThread', 'current_thread', 'enumerate', 'get_ident', 'local', 'main_thread', 'setprofile', 'settrace', 'stack_size']
    ['JSONDecodeError', 'JSONDecoder', 'JSONEncoder', '__all__', '__author__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__path__', '__spec__', '__version__', '_default_decoder', '_default_encoder', 'codecs', 'decoder', 'detect_encoding', 'dump', 'dumps', 'encoder', 'load', 'loads', 'scanner']


#### Import From Module
- You can choose to import only parts from a module, by using the from keyword.

```python
# The module named mymodule has function and dictionary:
def circle_area(radius):
    area = radius * radius * PI
    return area

p1 = {
  "name": "John",
  "age": 36,
  "country": "Norway"
}
```


```python
# Import only the person1 dictionary from the module:
from my_module import circle_area, p1

print('area', circle_area(3))
print('p1', p1)
```

    area 28.27433385
    p1 {'name': 'John', 'age': 36, 'country': 'Norway'}


### å…§å»ºmodule

#### OS æ¨¡çµ„
æä¾›é¡¯ç¤ºç³»çµ±ç’°å¢ƒåƒæ•¸èˆ‡æŒ‡ä»¤åŠŸèƒ½å‡½æ•¸
```python
os.rename(src, dst)
```
> å°æª”æ¡ˆæˆ–ç›®éŒ„æ›´æ›åç¨±
>
> srcå¼•æ•¸æ˜¯åŸæœ¬çš„è³‡æ–™å¤¾
>
>dstå¼•æ•¸æ˜¯ä¿®æ”¹å¾Œçš„è³‡æ–™å¤¾åç¨±

```python
os.remove(path) ç§»é™¤æª”æ¡ˆ
```

> pathå¼•æ•¸å‚³å…¥æª”æ¡ˆä½ç½®
>
> ä¸æœƒç§»é™¤è³‡æ–™å¤¾

```python
 os.removedirs(path)
```
> ç§»é™¤ç©ºçš„è³‡æ–™å¤¾ 

```python
 os.listdir(path)
```
>è¼¸å‡ºpathå¼•æ•¸ä½ç½®çš„ç›®éŒ„å’Œæª”æ¡ˆåç¨±

#### randomæ¨¡çµ„
```python
random.random()
```
>éš¨æ©Ÿç”¢ç”Ÿ0.0<=x<1.0ä¹‹é–“çš„æ•¸å­—
 
```python
random.uniform(num1, num2) 
```
>éš¨æ©Ÿç”¢ç”Ÿnum1<=x<num2çš„æ•¸å­—

```python
random.randint(1,10)  
```
>ç”¢ç”Ÿä¸€å€‹1åˆ°10çš„æ•¸å­—

```python
random.randrange(0,101) 
```
>ç”¢ç”Ÿä¸€å€‹0åˆ°100çš„æ•¸å­—

#### sysæ¨¡çµ„
```python
sys.version
```
> å›å‚³ç›®å‰å®‰è£åœ¨ç³»çµ±ä¸Šçš„Pythonç‰ˆæœ¬

```python
sys.argv[0]
```
> æœƒå›å‚³æ­¤ç¨‹å¼æª”æ¡ˆçš„ä½ç½®èˆ‡åç¨±

```python
sys.argv
```
> å¸¶å…¥åƒæ•¸ä»¥listå½¢å¼å„²å­˜

```python
sys.platform
```
> å–å¾—ç›®å‰ä½œæ¥­ç³»çµ±çš„ç‰ˆæœ¬

```python
sys.exit()
```
>å®£å‘Šsys.exit(0)çµ‚æ­¢ç¨‹å¼

### ç¬¬ä¸‰æ–¹module
> pythonç¤¾ç¾¤æä¾›äº†å¤§é‡çš„ç¬¬ä¸‰æ–¹æ¨¡çµ„ï¼Œä½¿ç”¨æ–¹å¼èˆ‡æ¨™æº–åº« é¡ä¼¼ã€‚å®ƒå€‘çš„åŠŸèƒ½ç„¡æ‰€ä¸åŒ…ï¼Œè¦†è“‹ç§‘å­¸è¨ˆç®—ã€ Webé–‹ç™¼ã€ è³‡æ–™åº«ä»‹é¢ã€åœ–å½¢ç³»çµ±å¤šå€‹é ˜åŸŸï¼Œä¸¦ä¸”å¤§ å¤šæˆç†Ÿè€Œç©©å®šã€‚ ç¬¬ä¸‰æ–¹æ¨¡çµ„å¯ä»¥ä½¿ç”¨Pythonæˆ–è€…Cèªè¨€ç·¨å¯«ã€‚

>æ‚¨ä¹Ÿè¨±è½éã€Œä¸è¦é‡é€ è¼ªå­ã€é€™å¥è©±ï¼Œæˆ–æ˜¯ DRY (Don't Repeat Yourself )ï¼Œè¬›å¾—å°±æ˜¯ã€Œåˆ¥äººå·²ç¶“å¯«å¥½çš„æ±è¥¿ï¼Œå°±æ‹¿å»ç”¨å§ï¼Œä¸ç”¨è‡ªå·±å†é‡æ–°å¯«ä¸€å¥—ã€ã€‚

#### å®‰è£æ–¹æ³•
- æ–¹æ³•1
    - ä¸‹è¼‰åŸå§‹ç¢¼ï¼Œæ‰‹å‹•åŸ·è¡Œ python3 setup.py install å®‰è£…
- æ–¹æ³•2
    - åˆ©ç”¨ç¬¬ä¸‰æ–¹å®‰è£å·¥å…·(å¦‚pipï¼Œeasy_installï¼Œdistributeç­‰) è‡ªå‹•åŒ–å·¥å…·å®‰è£
#### pip
- å®‰è£å¥—ä»¶
    - pip3 install SomePackage (è‡ªå‹•å®‰è£æœ€æ–°ç‰ˆæœ¬)
    - pip3 install SomePackage==1.0.4 (æŒ‡å®šç‰ˆæœ¬)
    - pip3 install 'SomePackage>=1.0.4' (æŒ‡å®šæœ€å°ç‰ˆæœ¬)
- æ›´æ–°å¥—ä»¶
    - pip3 install -U SamePackage
- åˆªé™¤å¥—ä»¶
    - pip3 uninstall SomePackage
    
python3 å¯ä»¥å®‰è£çš„å¥—ä»¶æœ‰å¾ˆå¤šå€‹ï¼Œéœ€è¦ä»€éº¼è‡ªå·±æ‰¾å§ï½

ä¾‹å¦‚æˆ‘ä½¿ç”¨ ujson é€™å€‹ Module

é¦–å…ˆä½¿ç”¨ `pip3` ä¸‹è¼‰


```python
!pip3 install ujson
```

    Defaulting to user installation because normal site-packages is not writeable
    Collecting ujson
      Using cached ujson-4.0.2-cp36-cp36m-manylinux1_x86_64.whl (179 kB)
    Installing collected packages: ujson
    Successfully installed ujson-4.0.2
    [33mWARNING: You are using pip version 20.1.1; however, version 21.0.1 is available.
    You should consider upgrading via the '/bin/python3.6 -m pip install --upgrade pip' command.[0m



```python
# è¨˜å¾—å…ˆé‡å•Ÿ notebook
import ujson

string = ujson.dumps([1, 4, 5, {'key': 'value'}])
print(string)
```

    [1,4,5,{"key":"value"}]


### Labç·´ç¿’

è«‹ä¸Šå‚³ä¸€å€‹å£“ç¸®æª”åŒ…å«ä»¥ä¸‹æª”æ¡ˆ

1. è‡ªå·±å¯«ä¸€å€‹ Module

è«‹å»ºç«‹å…©å€‹æª”æ¡ˆï¼š`main.py` å’Œ `lab_module.py`

è«‹æŠŠä¹‹å‰çš„ä½œæ¥­å…¶ä¸­ä¸€æ®µå¯«æˆ Functionï¼ˆä½ å¯ä»¥åƒè€ƒæˆ‘å…¬å¸ƒåœ¨ç¶²å¤§çš„è§£ç­”ï¼‰ä¸¦æ”¾åˆ° `lab_module.py`

ç„¶å¾Œå† `main.py` ä¸­å‘¼å« Moduleï¼Œè¨ˆç®—å®Œå‰©ä¸‹çš„éƒ¨åˆ†

2. å°‹æ‰¾ä¸€å€‹ç¬¬ä¸‰æ–¹ Module

è«‹ä¸Šç¶²æ‰¾ä¸€å€‹ Python ç¬¬ä¸‰æ–¹ Module å’Œä»–çš„ç¯„ä¾‹

è«‹ä¸Šå‚³ä¸€å€‹ .ipynb å«åšã€Œlab06_third.ipynbã€ï¼Œèªªæ˜é€™å€‹ Module çš„å…§å®¹å’Œç›®çš„æ˜¯å•¥ï¼Œä¸¦é™„ä¸Šç°¡å–®çš„ç¯„ä¾‹ code
